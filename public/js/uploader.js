define(["jquery","ajax"],function(e,n){var t={token:null,upload:function(t){var a=e('<form><input type="file" accept="image/*" name="file"><input type="hidden" name="token"></form>');a.find("[name=token]").val(this.token),e("body").append(a),a.find("[name=file]").on("change",function(){e.ajax({url:"http://up-z2.qiniu.com/",type:"POST",data:new FormData(a[0]),cache:!1,contentType:!1,processData:!1,beforeSend:function(){n.loading()},complete:function(){a.remove(),n.removeLoading()},success:function(e){"SUCCESS"===e.state&&e.url?t(e.url):alert(e.state)},error:function(e){alert("上传失败")}})}).click()}};return function(e){return t.token=e,t}});